<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Jaskiratâ€™s Roulette Table</title>
<style>
  :root {
    --felt:#0a6b3a;
    --gold:#f7c948;
    --red:#c1121f;
    --black:#111;
    --green:#0b7a29;
  }
  * { box-sizing: border-box; }
  body {
    margin: 0; background: radial-gradient(circle at 50% 0%, #0c8a49, #064728 60%);
    color: #fff; font-family: system-ui, -apple-system, Arial, sans-serif;
  }
  h1 { text-align:center; margin: 14px 10px; }
  .layout {
    display:flex; flex-wrap:wrap; justify-content:center; gap:18px; padding:10px 12px 30px;
  }

  /* --- Wheel --- */
  .wheel-wrap { position:relative; width: 360px; }
  .pointer {
    position:absolute; top:-6px; left:50%; transform:translateX(-50%);
    width: 0; height: 0; border-left: 12px solid transparent;
    border-right: 12px solid transparent; border-bottom: 24px solid var(--gold); z-index: 3;
    filter: drop-shadow(0 2px 0 rgba(0,0,0,.4));
  }
  svg#roulette {
    display:block; width:360px; height:360px; background:#222; border-radius:50%;
    border:10px solid #333; box-shadow: 0 8px 30px rgba(0,0,0,.45) inset, 0 6px 20px rgba(0,0,0,.35);
  }
  #wheelGroup { transform-origin: 180px 180px; transition: transform 5s cubic-bezier(.2,.8,.2,1); }

  /* --- Betting layout --- */
  .table {
    display:grid;
    grid-template-columns: 80px repeat(3, 64px);
    gap: 4px;
    background: #044b2a; padding: 6px; border-radius: 12px; border: 2px solid rgba(255,255,255,.12);
  }
  .cell, .outside {
    position:relative; height: 54px; display:flex; align-items:center; justify-content:center;
    border:1px solid rgba(255,255,255,.25); border-radius:8px; color:#fff; font-weight:700; user-select:none;
  }
  .cell.zero { background: var(--green); grid-row: span 12; grid-column: 1; font-size: 20px; }
  .cell.red { background: var(--red); }
  .cell.black { background: var(--black); }
  .cell.number { font-size: 18px; }
  .outside { background:#193; }
  .outside.red { background: var(--red); }
  .outside.black { background: var(--black); }
  .outsideBand { display:grid; grid-template-columns: repeat(3, 1fr); gap: 6px; margin-top: 8px; }
  .evenBand  { display:grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-top: 6px; }

  /* --- Chips --- */
  .denoms { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top: 8px; }
  .chipBtn {
    padding: 8px 10px; border-radius: 999px; background: var(--gold); color:#222; border:none; font-weight:800;
    box-shadow: 0 2px 0 rgba(0,0,0,.35); cursor:pointer;
  }
  .chipBtn.active { outline:3px solid #fff; }
  .chipBadge {
    position:absolute; right:4px; bottom:4px; width:30px; height:30px; border-radius:50%;
    background: var(--gold); color:#111; font-size: 12px; display:flex; align-items:center; justify-content:center; font-weight:900;
    box-shadow: 0 2px 0 rgba(0,0,0,.35);
  }

  /* --- Controls / balance --- */
  .panel { min-width: 340px; max-width: 440px; }
  .stats { text-align:center; margin-top: 8px; font-size: 16px; }
  .buttons { display:flex; gap:10px; justify-content:center; margin-top:10px; }
  .btn {
    padding:10px 14px; border-radius:10px; border:none; font-weight:800; cursor:pointer;
    background:#ffe08a; color:#111; box-shadow: 0 2px 0 rgba(0,0,0,.35);
  }
  .btn.secondary { background:#b3e5c9; }
  .btn.warn { background:#ffb3b3; }

  /* --- Popup --- */
  .popup {
    position:fixed; inset:0; display:none; align-items:center; justify-content:center;
    background: rgba(0,0,0,.6); z-index: 10;
  }
  .popup .card {
    background:#fff; color:#111; border-radius:14px; padding:18px 16px; width:min(90vw, 420px);
    text-align:center; box-shadow: 0 20px 60px rgba(0,0,0,.4);
  }
  .popup h3 { margin: 6px 0 10px; }
  .popup p { margin: 8px 0; }
</style>
</head>
<body>
  <h1>ðŸŽ° Jaskiratâ€™s Roulette Table</h1>

  <div class="layout">
    <!-- WHEEL -->
    <div class="wheel-wrap">
      <div class="pointer"></div>
      <svg id="roulette" viewBox="0 0 360 360" aria-label="Roulette Wheel">
        <g id="wheelGroup"></g>
        <!-- hub -->
        <circle cx="180" cy="180" r="22" fill="#eee"/>
        <circle cx="180" cy="180" r="8" fill="#666"/>
      </svg>
    </div>

    <!-- TABLE + CONTROLS -->
    <div class="panel">
      <div class="table" id="tableGrid"></div>

      <!-- Dozens -->
      <div class="outsideBand" id="dozensBand"></div>
      <!-- Even/odd & colors -->
      <div class="evenBand" id="evenBand"></div>

      <!-- Chip picker -->
      <div class="denoms">
        <button class="chipBtn active" data-denom="1">$1</button>
        <button class="chipBtn" data-denom="5">$5</button>
        <button class="chipBtn" data-denom="25">$25</button>
        <button class="chipBtn" data-denom="50">$50</button>
        <button class="chipBtn" data-denom="100">$100</button>
        <input id="customAmt" type="number" min="1" placeholder="Custom" style="width:90px; padding:8px; border-radius:8px; border:none"/>
        <button class="chipBtn" id="setCustom">Set</button>
      </div>

      <div class="stats">
        Balance: $<span id="balance">1000</span> &nbsp;â€¢&nbsp;
        Pending: $<span id="pending">0</span>
      </div>
      <div class="buttons">
        <button class="btn" id="spinBtn">Spin ðŸŽ¡</button>
        <button class="btn secondary" id="clearBtn">Clear Bets</button>
        <button class="btn warn" id="resetBtn">Reset Balance</button>
      </div>
      <div class="stats" id="lastResult">Last: â€“</div>
    </div>
  </div>

  <!-- Popups -->
  <div class="popup" id="welcomePop">
    <div class="card">
      <h3>Welcome to Jaskiratâ€™s Roulette Table</h3>
      <p>Select a chip ($1â€“$100 or custom), then tap a number or an outside bet (Red/Black, Odd/Even, or 1st/2nd/3rd 12).</p>
      <p>Press <b>Spin</b> to play. Payouts: Straight 35:1, Even-money 1:1, Dozens 2:1.</p>
      <button class="btn" onclick="closePop('welcomePop')">Letâ€™s Play</button>
    </div>
  </div>

  <div class="popup" id="resultPop">
    <div class="card">
      <h3 id="resTitle">Result</h3>
      <p id="resBody"></p>
      <button class="btn" onclick="closePop('resultPop')">OK</button>
    </div>
  </div>

<script>
/* -------------------- DATA -------------------- */
const wheelNumbers = [ // European order clockwise from 0
  0,32,15,19,4,21,2,25,17,34,6,27,13,36,11,30,8,
  23,10,5,24,16,33,1,20,14,31,9,22,18,29,7,28,12,35,3,26
];
const redNums = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
const colorOf = n => n===0 ? 'green' : (redNums.has(n) ? 'red' : 'black');

/* -------------------- STATE -------------------- */
let balance = 1000;
let pending = 0;
let currentChip = 1;
let currentRotation = 0; // degrees
// Bets stored by key -> { type, value, amount, cellEl, chipEl }
const bets = new Map();

/* -------------------- ELEMENTS -------------------- */
const balanceEl = document.getElementById('balance');
const pendingEl = document.getElementById('pending');
const lastResultEl = document.getElementById('lastResult');
const wheelGroup = document.getElementById('wheelGroup');
const tableGrid = document.getElementById('tableGrid');
const dozensBand = document.getElementById('dozensBand');
const evenBand = document.getElementById('evenBand');
const spinBtn = document.getElementById('spinBtn');
const clearBtn = document.getElementById('clearBtn');
const resetBtn = document.getElementById('resetBtn');

/* -------------------- HELPERS -------------------- */
function fmt(n){ return Number(n).toLocaleString('en-US'); }
function updateMoney(){
  balanceEl.textContent = fmt(balance);
  pendingEl.textContent = fmt(pending);
}
function openPop(id){ document.getElementById(id).style.display='flex'; }
function closePop(id){ document.getElementById(id).style.display='none'; }

/* -------------------- BUILD WHEEL (SVG) -------------------- */
(function buildWheel(){
  const N = wheelNumbers.length; // 37
  const cx=180, cy=180, rOuter=170, rInner=95, rText=135;
  const arc = 2*Math.PI/N;
  const start = -Math.PI/2; // pointer at top

  function polar(r, a){ return [cx + r*Math.cos(a), cy + r*Math.sin(a)]; }

  for(let i=0;i<N;i++){
    const a0 = start + i*arc;
    const a1 = a0 + arc;
    const aMid = (a0+a1)/2;
    const num = wheelNumbers[i];
    const fill = (num===0) ? '#0a8a3a' : (redNums.has(num) ? '#c1121f' : '#111');

    // Donut slice path
    const [ix0,iy0] = polar(rInner,a0);
    const [ox0,oy0] = polar(rOuter,a0);
    const [ox1,oy1] = polar(rOuter,a1);
    const [ix1,iy1] = polar(rInner,a1);
    const largeArc = 0;
    const d = [
      `M ${ix0} ${iy0}`,
      `L ${ox0} ${oy0}`,
      `A ${rOuter} ${rOuter} 0 ${largeArc} 1 ${ox1} ${oy1}`,
      `L ${ix1} ${iy1}`,
      `A ${rInner} ${rInner} 0 ${largeArc} 0 ${ix0} ${iy0}`,
      'Z'
    ].join(' ');
    const path = document.createElementNS('http://www.w3.org/2000/svg','path');
    path.setAttribute('d', d);
    path.setAttribute('fill', fill);
    path.setAttribute('stroke', '#222');
    path.setAttribute('stroke-width', '1');
    wheelGroup.appendChild(path);

    // Number label
    const [tx,ty] = polar(rText,aMid);
    const txt = document.createElementNS('http://www.w3.org/2000/svg','text');
    txt.setAttribute('x', tx);
    txt.setAttribute('y', ty);
    txt.setAttribute('fill', '#fff');
    txt.setAttribute('font-size', '13');
    txt.setAttribute('font-weight', '800');
    txt.setAttribute('text-anchor','middle');
    txt.setAttribute('dominant-baseline','middle');
    txt.textContent = num.toString();
    wheelGroup.appendChild(txt);
  }
})();

/* -------------------- BUILD TABLE -------------------- */
(function buildTable(){
  // Left 0 cell, spans 12 rows
  const zero = document.createElement('div');
  zero.className = 'cell zero number';
  zero.textContent = '0';
  zero.dataset.key = keyNumber(0);
  zero.addEventListener('click', () => placeBet('number', 0, zero));
  tableGrid.appendChild(zero);

  // 3 columns x 12 rows (roulette layout: 3-2-1 top -> 36-35-34 bottom)
  for(let row=0; row<12; row++){
    for(let col=0; col<3; col++){
      const num = row*3 + (3-col); // 3,2,1 | 6,5,4 ... 36,35,34
      const cell = document.createElement('div');
      cell.className = `cell number ${redNums.has(num)?'red':'black'}`;
      cell.textContent = num;
      cell.dataset.key = keyNumber(num);
      cell.addEventListener('click', () => placeBet('number', num, cell));
      tableGrid.appendChild(cell);
    }
  }

  // Dozens: 1â€“12 / 13â€“24 / 25â€“36
  [
    {label:'1st 12', v:1},
    {label:'2nd 12', v:2},
    {label:'3rd 12', v:3},
  ].forEach(d=>{
    const div = document.createElement('div');
    div.className = 'outside';
    div.textContent = d.label;
    div.dataset.key = keyDozen(d.v);
    div.addEventListener('click', ()=>placeBet('dozen', d.v, div));
    dozensBand.appendChild(div);
  });

  // Even/odd & colors
  [
    {label:'EVEN', type:'evenodd', v:'even'},
    {label:'ODD', type:'evenodd', v:'odd'},
    {label:'RED', type:'color', v:'red', class:'red'},
    {label:'BLACK', type:'color', v:'black', class:'black'},
  ].forEach(b=>{
    const div = document.createElement('div');
    div.className = `outside ${b.class||''}`.trim();
    div.textContent = b.label;
    div.dataset.key = (b.type==='color') ? keyColor(b.v) :
                      (b.type==='evenodd') ? keyEvenOdd(b.v) : '';
    div.addEventListener('click', ()=>placeBet(b.type, b.v, div));
    evenBand.appendChild(div);
  });
})();

/* -------------------- CHIP PICKER -------------------- */
let denomButtons = [...document.querySelectorAll('.chipBtn[data-denom]')];
denomButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    denomButtons.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentChip = parseInt(btn.dataset.denom,10);
  });
});
document.getElementById('setCustom').addEventListener('click', ()=>{
  const v = parseInt(document.getElementById('customAmt').value,10);
  if(v>0){
    denomButtons.forEach(b=>b.classList.remove('active'));
    currentChip = v;
    // briefly highlight the Set button
    const btn = document.getElementById('setCustom');
    btn.classList.add('active');
    setTimeout(()=>btn.classList.remove('active'), 500);
  }
});

/* -------------------- BET KEYS -------------------- */
function keyNumber(n){ return `N-${n}`; }
function keyColor(c){ return `C-${c}`; }
function keyEvenOdd(e){ return `EO-${e}`; }
function keyDozen(d){ return `D-${d}`; }

/* -------------------- PLACE BET -------------------- */
function ensureChipOnCell(cell, amount){
  let badge = cell.querySelector('.chipBadge');
  if(!badge){
    badge = document.createElement('div');
    badge.className = 'chipBadge';
    cell.appendChild(badge);
  }
  badge.textContent = '$' + fmt(amount);
  return badge;
}

function placeBet(type, value, cellEl){
  const amt = parseInt(currentChip,10);
  if(!(amt>0)) return;
  if(balance < amt){ openResult('Not enough balance', 'Reduce your chip or clear bets.'); return; }

  const key =
    type==='number' ? keyNumber(value) :
    type==='color' ? keyColor(value) :
    type==='evenodd' ? keyEvenOdd(value) :
    type==='dozen' ? keyDozen(value) : '';

  // update or create
  let entry = bets.get(key);
  if(entry){
    entry.amount += amt;
  } else {
    entry = { type, value, amount: amt, cellEl, chipEl: null };
    bets.set(key, entry);
  }

  // money movement
  balance -= amt;
  pending += amt;
  updateMoney();

  // update chip badge
  entry.chipEl = ensureChipOnCell(cellEl, entry.amount);
}

/* -------------------- CLEAR BETS (REFUND) -------------------- */
clearBtn.addEventListener('click', ()=>{
  if(bets.size===0) return;
  let refund = 0;
  for(const [,b] of bets) refund += b.amount;
  balance += refund;
  pending = 0;
  for(const [,b] of bets){
    if(b.cellEl && b.chipEl) b.chipEl.remove();
  }
  bets.clear();
  updateMoney();
});

/* -------------------- RESET BALANCE -------------------- */
resetBtn.addEventListener('click', ()=>{
  // also clears bets
  clearBtn.click();
  balance = 1000;
  updateMoney();
});

/* -------------------- SPIN -------------------- */
spinBtn.addEventListener('click', spin);

function spin(){
  if(bets.size===0){ openResult('Place a bet first', 'Tap a chip, then tap the table.'); return; }
  // choose a random winning pocket
  const idx = Math.floor(Math.random() * wheelNumbers.length);
  const winNum = wheelNumbers[idx];

  // compute rotation to land winNum at the pointer (top)
  // center angles for each index (deg)
  const arcDeg = 360 / wheelNumbers.length; // ~9.7297
  const centerAngle = -90 + (idx + 0.5) * arcDeg; // -90 is top
  // we want (centerAngle + newRotation) % 360 == 0
  let newRotation = -centerAngle;
  while(newRotation <= currentRotation + 720) newRotation += 360; // at least 2 extra spins

  // animate
  wheelGroup.style.transition = 'transform 5s cubic-bezier(.2,.8,.2,1)';
  wheelGroup.style.transform = `rotate(${newRotation}deg)`;
  currentRotation = newRotation;

  // settle after animation
  setTimeout(()=> {
    const winColor = colorOf(winNum);
    const {winnings, detail} = settle(winNum);
    pending = 0;
    balance += winnings;
    updateMoney();

    // Clear chips
    for(const [,b] of bets){ if(b.chipEl) b.chipEl.remove(); }
    bets.clear();

    lastResultEl.textContent = `Last: ${winNum} (${winColor}) â€¢ Won $${fmt(winnings)}`;
    openResult(`Result: ${winNum} (${winColor})`,
               `Total won: $${fmt(winnings)}<br>${detail}`);
  }, 5200);
}

/* -------------------- PAYOUTS -------------------- */
function inDozen(n, d){
  if(d===1) return n>=1 && n<=12;
  if(d===2) return n>=13 && n<=24;
  if(d===3) return n>=25 && n<=36;
  return false;
}
function settle(winNum){
  let total = 0;
  const lines = [];
  const winColor = colorOf(winNum);

  for(const [key, b] of bets){
    let pay = 0;
    if(b.type==='number'){
      if(b.value===winNum) pay = b.amount * 36; // includes stake
    } else if(b.type==='color'){
      if(winNum!==0 && b.value===winColor) pay = b.amount * 2;
    } else if(b.type==='evenodd'){
      if(winNum!==0){
        if(b.value==='even' && winNum%2===0) pay = b.amount * 2;
        if(b.value==='odd'  && winNum%2===1) pay = b.amount * 2;
      }
    } else if(b.type==='dozen'){
      if(inDozen(winNum, b.value)) pay = b.amount * 3;
    }
    if(pay>0){
      lines.push(`${labelFor(b)} â†’ $${fmt(pay)}`);
      total += pay;
    }
  }
  if(lines.length===0) lines.push('No winning bets ðŸ˜•');
  return {winnings: total, detail: lines.join('<br>')};
}

function labelFor(b){
  if(b.type==='number') return `#${b.value}`;
  if(b.type==='color')  return b.value.toUpperCase();
  if(b.type==='evenodd') return b.value.toUpperCase();
  if(b.type==='dozen'){
    return b.value===1 ? '1st 12' : b.value===2 ? '2nd 12' : '3rd 12';
  }
  return '';
}

/* -------------------- INIT -------------------- */
updateMoney();
openPop('welcomePop');
</script>
</body>
</html>
